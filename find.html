<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./style.css">
    <script type="javascript" src="backend.js"></script>
    <link rel="stylesheet" href="style.css">
    <title>Home</title>
    <!-- DATABASE CONNECTION DON'T TOUCH -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <!-- Database connection: Firebase is basically MongoDB, the following code is copied from Firebase-->
    <script>
        console.log("STARTING DB CONNECTION");
        // Your web app's Firebase configuration
        firebase.initializeApp({
            apiKey: "AIzaSyBHPV6k7TkSCmRvu3aPnaExWZZaaBQuY6g",
            authDomain: "cis440-capstone.firebaseapp.com",
            projectId: "cis440-capstone",
            storageBucket: "cis440-capstone.appspot.com",
            messagingSenderId: "949879801088",
            appId: "1:949879801088:web:9df9adc21bb46f2f195fe5"
        });
        console.log("INITIALIZED FIREBASE");
      
        // Initialize Database
        var db = firebase.firestore();

        function loadTopNav() {
            // Dynamically load top nav

            // -- Original HTML Code for Top Nav
            // <a class="active" href="./home.html">Home</a>
            // <a href="./find.html">Find a Bathroom</a>
            // <a href="./rate.html">Rate</a>

            // -- Get UID from URL Params
            const queryString = window.location.search;
            const urlParams = new URLSearchParams(queryString);
            const uid = urlParams.get('uid');
            
            // -- Find Top Nav Div
            var topNavDiv = document.getElementById("topnav");

            // -- Load Links
            // -- -- Home Link (Active)
            let homeLink = document.createElement('a');
            let homeLinkText = document.createTextNode('Home');
            homeLink.appendChild(homeLinkText);
            homeLink.href =  './home.html?uid=' + uid;
            topNavDiv.appendChild(homeLink);
            // -- -- Find Link
            let findLink = document.createElement('a');
            let findLinkText = document.createTextNode('Find a Bathroom');
            findLink.appendChild(findLinkText);
            findLink.setAttribute('class', 'active');
            findLink.href = './find.html?uid=' + uid;
            topNavDiv.appendChild(findLink);
            // -- -- Rate Link
            let rateLink = document.createElement('a');
            let rateLinkText = document.createTextNode('Rate');
            rateLink.appendChild(rateLinkText);
            rateLink.href = './rate.html?uid=' + uid;
            topNavDiv.appendChild(rateLink);
            // -- -- Logout Link
            let logout = document.createElement('a');
            let logoutText = document.createTextNode('Logout');
            logout.appendChild(logoutText);
            logout.href = './index.html'
            topNavDiv.appendChild(logout);
            // End Dynamically Load Top Nav
        }

        function loadLocations() {
            // Dynamically Load the Sample Locations

            // Original HTML Code for locations
            // <div class="locationProf">
            //     <a href="./Barrett Honors Hall.html"><h2>Barrett Honors Hall</h2></a>
            // </div>
            // <div class="locationProf">
            //     <a href="./Business Administration.html"><h2>Business Administration</h2></a>
            // </div>
            // <div class="locationProf">
            //     <a href="./Business Administration C-Wing.html"><h2>Business Administration C-Wing</h2></a>
            // </div>
            // <div class="locationProf">
            //     <a href="./Hayden Library.html"><h2>Hayden Library</h2></a>
            // </div>
            // <div class="locationProf">
            //     <a href="./Memorial Union.html"><h2>Memorial Union</h2></a>
            // </div>

            // -- Get UID from URL Params
            const queryString = window.location.search;
            const urlParams = new URLSearchParams(queryString);
            const uid = urlParams.get('uid');

            // Find the locations div tag in the DOM
            // -- This is where we are putting the different locations links
            let locationsDiv = document.getElementById("locations");

            // Add in the location links and append them to the locations div tag
            // -- Barrett Honors Hall
            // -- -- Create DOM Elements
            let barrettTextNode = document.createTextNode("Barrett Honors Hall");
            let barrettH2Tag = document.createElement('h2');
            let barrettAnchorTag = document.createElement('a');
            barrettAnchorTag.href = "./locations/Barrett Honors Hall.html?uid=" + uid;
            let barrettDiv = document.createElement('div');
            barrettDiv.setAttribute('class', 'locationProf');
            // -- -- Link DOM Elements Together
            barrettH2Tag.appendChild(barrettTextNode);
            barrettAnchorTag.appendChild(barrettH2Tag);
            barrettDiv.appendChild(barrettAnchorTag);
            locationsDiv.appendChild(barrettDiv);

            // -- Business Administration
            // -- -- Create DOM Elements
            let busAdmTextNode = document.createTextNode("Business Administration");
            let busAdmH2Tag = document.createElement('h2');
            let busAdmAnchorTag = document.createElement('a');
            busAdmAnchorTag.href = "./locations/Business Administration.html?uid=" + uid;
            let busAdmDiv = document.createElement('div');
            busAdmDiv.setAttribute('class', 'locationProf');
            // -- -- Link DOM Elements Together
            busAdmH2Tag.appendChild(busAdmTextNode);
            busAdmAnchorTag.appendChild(busAdmH2Tag);
            busAdmDiv.appendChild(busAdmAnchorTag);
            locationsDiv.appendChild(busAdmDiv);

            // -- Business Administration C-Wing
            // -- -- Create DOM Elements
            let busAdmCWingTextNode = document.createTextNode("Business Administration C-Wing");
            let busAdmCWingH2Tag = document.createElement('h2');
            let busAdmCWingAnchorTag = document.createElement('a');
            busAdmCWingAnchorTag.href = "./locations/Business Administration C-Wing.html?uid=" + uid;
            let busAdmCWingDiv = document.createElement('div');
            busAdmCWingDiv.setAttribute('class', 'locationProf');
            // -- -- Link DOM Elements Together
            busAdmCWingH2Tag.appendChild(busAdmCWingTextNode);
            busAdmCWingAnchorTag.appendChild(busAdmCWingH2Tag);
            busAdmCWingDiv.appendChild(busAdmCWingAnchorTag);
            locationsDiv.appendChild(busAdmCWingDiv);

            // -- Hayden Library
            // -- -- Create DOM Elements
            let haydenTextNode = document.createTextNode("Hayden Library");
            let haydenH2Tag = document.createElement('h2');
            let haydenAnchorTag = document.createElement('a');
            haydenAnchorTag.href = "./locations/Hayden Library.html?uid=" + uid;
            let haydenDiv = document.createElement('div');
            haydenDiv.setAttribute('class', 'locationProf');
            // -- -- Link DOM Elements Together
            haydenH2Tag.appendChild(haydenTextNode);
            haydenAnchorTag.appendChild(haydenH2Tag);
            haydenDiv.appendChild(haydenAnchorTag);
            locationsDiv.appendChild(haydenDiv);

            // -- Memorial Union
            // -- -- Create DOM Elements
            let memorialUnionTextNode = document.createTextNode("Memorial Union");
            let memorialUnionH2Tag = document.createElement('h2');
            let memorialUnionAnchorTag = document.createElement('a');
            memorialUnionAnchorTag.href = "./locations/Memorial Union.html?uid=" + uid;
            let memorialUnionDiv = document.createElement('div');
            memorialUnionDiv.setAttribute('class', 'locationProf');
            // -- -- Link DOM Elements Together
            memorialUnionH2Tag.appendChild(memorialUnionTextNode);
            memorialUnionAnchorTag.appendChild(memorialUnionH2Tag);
            memorialUnionDiv.appendChild(memorialUnionAnchorTag);
            locationsDiv.appendChild(memorialUnionDiv);



        }

        window.onload = () => {
            loadTopNav();
            loadLocations();
        }

        // --- Sample Code for Database Usage ---

        // 
        /* db.collection("reviews").add({
            location: "Hayden",
            type: "Gender",
            rating: 5,
            comment: "Please Help"
        })
        .then((docRef) => {
            console.log("Document written with ID: ", docRef.id);
        })
        .catch((error) => {
            console.error("Error adding document: ", error);
        }); */

        // Sample code for reading the Firebase Database
        /* db.collection("reviews").get().then((querySnapshot) => {
            querySnapshot.forEach((doc) => {
                console.log(`${doc.id} => ${doc.data()}`);
            });
        }); */

        // --- End of Sample Code ---
        
        // function displayHonorsHall() {
        //     db.collection("reviews").where("location", "==", "Barrett Honors Hall").get().then((querySnapshot)=> {
        //         querySnapshot.forEach((doc)=> {
        //             var honorsHallDiv = document.getElementById("honorsHallProf")

        //             //Construction new div element 
        //             let pgrph = document.createElement("div");
        //             pgrph.setAttribute("id", "profile")

        //             //Location line
        //             var locationText = document.createTextNode(doc.data().location)
        //         })
        //     })
        // }
       </script>
    <!-- END OF DATABASE CONNECTION -->
</head>

<body>
    <div id="topnav">
        <!-- Dynamically Loaded in JS -->
    </div>

    <div>
        <h1>Rate My Bathroom</h1>
    </div>

    <div id="locations">
        <!-- Dynamically Loaded in JS -->
    </div>
    
        
</body>
</html>

